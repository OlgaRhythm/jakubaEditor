<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JakubaEditor</title>

    <style>
        #editor {
            max-width: 50%; 
            width: 500px; 
            height: 200px; 
            border: 1px solid #000;
            padding: 15px 10px;
        }

        .toolbar {
            cursor: pointer;
            /*font-size: 16px;
            line-height: 26px;*/
        }

        .toolbar *{
            white-space: nowrap;
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none; /* Safari */
            -khtml-user-select: none; /* Konqueror HTML */
            -moz-user-select: none; /* Old versions of Firefox */
            -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none;
        }

        .toolbar button {
            display: block;
            cursor: pointer;
            font-family: inherit;
            margin: 0;
            padding: 0 5px;
            border: none;
            background: none;
            font-size: 16px;
            line-height: 26px;
            width: 100%;
        }
        .toolbar div {
            display: inline-block;
        }

        .toolbar div ul {
            width: 120px;
        }

        .toolbar div ul ul {
            width: auto;
        }

        .toolbar div ul, 
        .toolbar div ul ul,
        .toolbar div.active ul ul {
            display: none;
            border: #000 1px solid;
            padding: 0;
            margin: 0;
            cursor: pointer;
        }
        .toolbar div.active>ul,
        .toolbar div.active ul>li.active>ul {
            display: block;
            position: absolute;
            background: #fff;
        }
        .toolbar li {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .toolbar div ul li:hover {
            background: #ccc;
        }
        .toolbar div.active ul li ul {
            left: 100%;
            margin-top: -27px;
        }
    </style>

        <!-- Описание функций -->
        <script>
        
            class JakubaEditor {
                containerId;
            
                constructor (_containerId) {
                    this.containerId = _containerId;
                    
                    document.addEventListener('DOMContentLoaded', function() {
                        // работа меню
                        document.querySelectorAll('#' + this.containerId + " .toolbar>div").forEach(function(element) {
                            element.addEventListener("click", function() {
                                element.classList.add("active");
                            });
                        });
                        document.querySelectorAll('#' + this.containerId + " .toolbar>div>ul>li").forEach(function(element) {
                            element.addEventListener("click", function() {
                                element.classList.toggle("active");
                            });
                        });
                        document.addEventListener("mousedown", function(element) {
                            var target = event.target;
                            if (!target.closest('#' + this.containerId + " .toolbar>div>ul>li")) {
                                document.querySelectorAll('#' + this.containerId + " .toolbar>div, #" + this.containerId + " .toolbar>div>ul>li").forEach(function(element) {
                                    element.classList.remove("active");
                                }.bind(this));
                            }
                            if (!target.closest('#' + this.containerId + " .toolbar>div>ul>li>ul")) {
                                document.querySelectorAll('#' + this.containerId + " .toolbar>div>ul>li").forEach(function(element) {
                                    element.classList.remove("active");
                                });
                            }
                        }.bind(this));
                    }.bind(this));
                }
            
                // жирный шрифт, bold
                setBold() {
                    document.execCommand('bold', false, null);
                }
                // курсивный шрифт, italic
                setItalic() {
                    document.execCommand('italic', false, null);
                }
                // нижнее подчёркивание, underline
                setUnderline() {
                    document.execCommand('underline', false, null);
                }
                // зачёркивание текста, strikeThrough
                setStrikeThrough() {
                    document.execCommand('strikeThrough', false, null);
                }
                // размер шрифта
                setFontSize(fontSizePt) {
                    var selection = window.getSelection().toString();
                    var wrappedselection = '<span style="font-size: ' + fontSizePt + '">' + selection + '</span>';
                    document.execCommand('insertHTML', false, wrappedselection);
                }
                
                // шрифт
                setFont(fontFamily) {
                    document.execCommand('fontName', false, fontFamily);
                }
                
                // обновление контента скрытой textarea
                updateHiddenText() {
                    document.getElementById('jakuba_editor_content').value = document.getElementById('editor').innerHTML;
                }

                /**
                 * Возвращает актуальное содержимое редактора
                */
                getContent() {

                }
            } 
        </script>

</head>
<body>

    <!-- Тестирование работы в редакторе -->
    <h1>Текстовый редактор JakubaEditor</h1>

    <script>
        let editorObj1 = new JakubaEditor("text-editor");
    </script>
	
	<form action="#" method="post" onsubmit="return save()">
<!-- ######################################################################################################################## -->       
    <div id="text-editor">
        <!-- Toolbar -->
        <div class="toolbar">
            <div class="file">File</div>
            <div class="edit">Edit</div>
            <div class="view">View</div>
            <div class="insert">Insert</div>
            <div class="format">Format
                <ul>
                    <li>Fonts sizes >
                        <ul>
                            <li style="font-size: 8pt;" onclick="editorObj1.setFontSize('8pt')">8pt</li>
                            <li style="font-size: 10pt;" onclick="editorObj1.setFontSize('10pt')">10pt</li>
                            <li style="font-size: 12pt;" onclick="editorObj1.setFontSize('12pt')">12pt</li>
                            <li style="font-size: 14pt;" onclick="editorObj1.setFontSize('14pt')">14pt</li>
                        </ul>
                    </li>
                    <li>Fonts >
                        <ul>
                            <li style="font-family: 'Times New Roman';" onclick="editorObj1.setFont('Times New Roman')">Times New Roman</li>
                            <li style="font-family: 'Arial';" onclick="editorObj1.setFont('Arial')">Arial</li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div id="help">Help</div>
        </div>
        <!-- Панель быстрого доступа -->
        <div id="quick-tools">           
            <button onclick="editorObj1.setBold()">Bold</button>
            <button onclick="editorObj1.setItalic()">Italic</button>
            <button onclick="editorObj1.setUnderline()">Underline</button>
            <button onclick="editorObj1.setStrikeThrough()">Strikethrough</button>
        </div>

        <textarea id="jakuba_editor_content" style="display: none;"></textarea>
        <div id="editor" contenteditable="true"><div>Type your text here...</div></div>

    </div>
<!-- ######################################################################################################################## --> 
    <script>
        /**
         * Принимает содержимое редактора и присваевает его переменной страницы для отображения
        */
        function save() {
            document.getElementById("result").innerHTML = document.getElementById("jakuba_editor_content").value;
            return false;
          
            
        }
        function updateText() {
            editorObj1.updateHiddenText();
            save();
        }
    </script>

    <br>
    <button type="submit" onclick="updateText()">Обновить</button>
    </form>

    
    <!-- Результат работы -->
    <hr color="black" size="3" width="100%">
    <h1>Содержимое текстового редактора</h1>
    <div id="result"></div>
    
</body>
</html>